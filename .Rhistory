panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.margin=unit(c(1,25,1,1), "mm"))
grid.raster(rbanism_logo,
x = 0.74, y=0.1,
width = unit(55, "points"))
library(sf)
library(tidyverse)
library(magick)
library(magrittr)
library(grid)
rbanism_logo <- image_read('Logos/Logo transparent background/Logo_White.png')
# Data from: https://doi.org/10.5281/zenodo.11196161
# Datapaper: https://journals.openedition.org/cybergeo/41791
roads1810 <- read.csv("2Nov_Lines/data/roads_1810.csv")
relays1810 <- read.csv("2Nov_Lines/data/relays_1810.csv")
relays <- st_as_sf(relays1810,
coords = c("COORDINATES_2154_X", "COORDINATES_2154_Y"))
st_crs(relays) <- st_crs(postal_roads)
library(sf)
library(tidyverse)
library(magick)
library(magrittr)
library(grid)
rbanism_logo <- image_read('Logos/Logo transparent background/Logo_White.png')
roads1810 <- read.csv("2Nov_Lines/data/roads_1810.csv")
relays1810 <- read.csv("2Nov_Lines/data/relays_1810.csv")
relays <- st_as_sf(relays1810,
coords = c("COORDINATES_2154_X", "COORDINATES_2154_Y"))
st_crs(relays) <- st_crs(postal_roads)
xyrelays_A <- relays1810 |>
mutate(IDREL_A = IDREL,
COORDINATES_2154_X_A = COORDINATES_2154_X,
COORDINATES_2154_Y_A = COORDINATES_2154_Y) |>
select(IDREL_A, COORDINATES_2154_X_A,COORDINATES_2154_Y_A)
xyrelays_B <- relays1810 |>
mutate(IDREL_B = IDREL,
COORDINATES_2154_X_B = COORDINATES_2154_X,
COORDINATES_2154_Y_B = COORDINATES_2154_Y) |>
select(IDREL_B, COORDINATES_2154_X_B,COORDINATES_2154_Y_B)
roads <- roads1810 |>
left_join(xyrelays_A, by="IDREL_A") |>
left_join(xyrelays_B, by="IDREL_B" )
############## Bit of code adapted from
#https://www.adventuremeng.com/post/create-sf-lines-from-start-and-end-coordinates/
library(sp)
od_coords_to_sf <- function(df) {
#prepare the table from wide to long
part1 <-df[,c(2,11,12)]  %>%
mutate(shape_pt_sequence =1) %>%
rename(shape_pt_lat = COORDINATES_2154_Y_A,
shape_pt_lon = COORDINATES_2154_X_A)
part2 <-df[,c(2,13,14)]  %>%
mutate(shape_pt_sequence =2) %>%
rename(shape_pt_lat=COORDINATES_2154_Y_B,
shape_pt_lon=COORDINATES_2154_X_B)
allpart <- rbind(part1, part2)
allpart<-allpart %>% arrange(colnames(df[1]))
m <- as.matrix(allpart[order(allpart$shape_pt_sequence),
c("shape_pt_lon", "shape_pt_lat")])
m <- sf::st_linestring(m)
shape_linestrings <- sf::st_sfc(m, crs = 2154)
shapes_sf <- sf::st_sf(IDROAD =allpart$IDROAD, geometry = shape_linestrings)
shapes_sf <-shapes_sf %>% distinct(IDROAD, .keep_all = TRUE)
return(shapes_sf)
}
all_segment <- data.frame()
for (i in 1:nrow(roads)){
one_seg <- roads[i,] %>% od_coords_to_sf()
all_segment <- rbind(all_segment, one_seg)
}
all_roads <- left_join(all_segment,roads)
fr <- st_read("2Nov_Lines/data/fr.json") |>
st_union()
fr_lambert <- st_transform(fr, crs = 2154)
ggplot() +
geom_sf(data=fr, fill = alpha("#F7931E", 0.99), col = NA) +
geom_sf(data = all_roads, aes(col = MAX_SLOPE), linewidth = 0.5) +
scale_colour_gradient(high="#11686C", low = "white") +
theme_minimal() +
ggtitle("2 November: Lines. Horses, beware!\nPostal horse roads in 1810 France") +
xlab(str_wrap("#30DayMapChallenge. Clémentine Cottineau-Mugadza, 2025. Source: Verdier, N., Giraud, T., Mimeur, C., & Bretagnolle, A. (2024). Postal horse relays and roads in France, from the 17th to the 19th centuries.Zenodo. https://doi.org/10.5281/zenodo.11196161")) +
coord_sf(crs = sf::st_crs(2154)) +
guides(col=guide_legend(title="Maximum slope (m)"), legend.position="bottom") +
theme(plot.background = element_rect(fill = alpha("#f5d89b", 0.9),
color = NA),
axis.title.x=element_text(family="Fira Code", hjust = 0, size=6,colour = "white"),
plot.title = element_text(face = "bold", family="Fira Code", size=14, colour = "white"),
legend.title = element_text(face = "bold", family="Fira Code", size=10, colour = "white"),
legend.text =element_text(family="Fira Code", size=8, colour = "white"),
axis.line =  element_blank(),
plot.margin = margin(10, 20, 10, 20),
axis.text =  element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
grid.raster(rbanism_logo,
x = 0.82, y=0.12,
width = unit(40, "points"))
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
library(sf)
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
library(sf)
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
# 3. Plot both layers in ggplot2
ggplot2() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
library(sf)
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
library(rnaturalearthdata)
library(sf)
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
library(sf)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)
# 1. Get a world map (in geographic coordinates, EPSG:4326)
world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Create a UTM-projected version (for example, UTM zone 33N: EPSG:32633)
world_utm <- st_transform(world, crs = 32633)
# 3. Plot both layers in ggplot2
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World Map: WGS84 (gray) + UTM Zone 33N (red overlay)")
library(sf)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)
# 1. Get a world map (in geographic coordinates, EPSG:4326)
world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Create a UTM-projected version (for example, UTM zone 33N: EPSG:32633)
world_utm_wgs84 <- st_transform(world_utm, st_crs(world))
ggplot() +
geom_sf(data = world, fill = "lightgray", color = "black", alpha = 0.5) +
geom_sf(data = world_utm_wgs84, fill = NA, color = "red") +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("World map correctly aligned (WGS84)")
library(sf)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)
# 1. Get a world map (in geographic coordinates, EPSG:4326)
world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Create a UTM-projected version (for example, UTM zone 33N: EPSG:32633)
world_utm_wgs84 <- st_transform(world_utm, st_crs(world))
library(patchwork)
p1 <- ggplot(world) +
geom_sf(fill = "lightgray", color = "black") +
coord_sf(crs = st_crs(4326)) +
ggtitle("Geographic (WGS84)")
p2 <- ggplot(world_utm) +
geom_sf(fill = "lightgray", color = "black") +
coord_sf(crs = st_crs(32633)) +
ggtitle("UTM Zone 33N")
p1 + p2
library(sf)
library(ggplot2)
library(rnaturalearth)
world <- ne_countries(scale = "medium", returnclass = "sf")
# Crop to Europe
europe <- st_crop(world, xmin = -15, xmax = 35, ymin = 35, ymax = 70)
# Reproject that region to UTM Zone 33N
europe_utm <- st_transform(europe, crs = 32633)
# Compare
library(patchwork)
p1 <- ggplot(europe) +
geom_sf(fill = "lightgray", color = "black") +
ggtitle("Europe - Geographic (WGS84)")
p2 <- ggplot(europe_utm) +
geom_sf(fill = "lightgray", color = "black") +
ggtitle("Europe - UTM Zone 33N")
p1 + p2
library(sf)
library(ggplot2)
library(rnaturalearth)
# 1. Get Africa in WGS84
africa <- ne_countries(continent = "Africa", returnclass = "sf")
# 2. Make a UTM version
africa_utm <- st_transform(africa, crs = 32733)  # UTM zone 33 SOUTH (EPSG:32733)
# 3. Convert the UTM version BACK to WGS84 for plotting
#    (so both layers use the same coordinate space)
africa_utm_wgs84 <- st_transform(africa_utm, crs = st_crs(africa))
# 4. Plot both together
ggplot() +
geom_sf(data = africa, fill = "lightgray", color = "black", alpha = 0.6) +
geom_sf(data = africa_utm_wgs84, fill = NA, color = "red", size = 0.6) +
coord_sf(crs = st_crs(4326)) +
theme_minimal() +
ggtitle("Africa overlay: WGS84 (gray) vs UTM Zone 33S (red)")
library(sf)
library(ggplot2)
library(rnaturalearth)
# 1. Get Northern Europe region
nordics <- ne_countries(continent = "Europe", returnclass = "sf")
nordics <- st_crop(nordics, xmin = -40, xmax = 40, ymin = 50, ymax = 80)
library(sf)
library(ggplot2)
library(rnaturalearth)
sf_use_s2(FALSE)  # <— prevents spherical geometry crossing error
nordics <- ne_countries(continent = "Europe", returnclass = "sf")
nordics <- st_crop(nordics, xmin = -40, xmax = 40, ymin = 50, ymax = 80)
nordics <- st_make_valid(nordics)
nordics_merc <- st_transform(nordics, 3857)
nordics_equalarea <- st_transform(nordics, "+proj=laea +lat_0=65 +lon_0=-18")
nordics_equalarea_wgs84 <- st_transform(nordics_equalarea, st_crs(nordics))
nordics_merc_wgs84 <- st_transform(nordics_merc, st_crs(nordics))
ggplot() +
geom_sf(data = nordics_merc_wgs84, fill = "lightgray", color = "black", alpha = 0.7) +
geom_sf(data = nordics_equalarea_wgs84, fill = NA, color = "red", size = 0.8) +
coord_sf(xlim = c(-40, 40), ylim = c(50, 80), expand = FALSE) +
theme_minimal() +
ggtitle("Mercator (gray) vs Equal-area (red) — Distortion near Iceland")
library(sf)
library(ggplot2)
library(rnaturalearth)
sf_use_s2(FALSE)  # <— prevents spherical geometry crossing error
nordics <- ne_countries(continent = "Europe", returnclass = "sf")
nordics <- st_crop(nordics, xmin = -40, xmax = 40, ymin = 50, ymax = 80)
nordics <- st_make_valid(nordics)
nordics_merc <- st_transform(nordics, 3857)
nordics_equalarea <- st_transform(nordics, "+proj=laea +lat_0=65 +lon_0=-18")
nordics_equalarea_wgs84 <- st_transform(nordics_equalarea, st_crs(nordics))
nordics_merc_wgs84 <- st_transform(nordics_merc, st_crs(nordics))
ggplot() +
geom_sf(data = nordics_merc_wgs84, fill = "lightgray", color = "black", alpha = 0.7) +
geom_sf(data = nordics_equalarea_wgs84, fill = NA, color = "red", size = 0.8) +
coord_sf(xlim = c(-40, 40), ylim = c(50, 80), expand = FALSE) +
theme_minimal() +
ggtitle("Mercator (gray) vs Equal-area (red) — Distortion near Iceland")
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)
# Get data
world <- ne_countries(scale = "medium", returnclass = "sf")
nordics <- st_crop(world, xmin = -40, xmax = 40, ymin = 50, ymax = 80)
nordics <- st_make_valid(nordics)
# Mercator
merc <- st_transform(nordics, 3857)
# Equal-area
laea <- st_transform(nordics, "+proj=laea +lat_0=65 +lon_0=-18")
p1 <- ggplot(merc) +
geom_sf(fill = "lightgray") +
ggtitle("Mercator (EPSG:3857)")
p2 <- ggplot(laea) +
geom_sf(fill = "lightgray") +
ggtitle("Equal-Area (LAEA)")
p1 + p2
library(sf)
library(ggplot2)
library(rnaturalearth)
library(dplyr)
sf::sf_use_s2(FALSE)   # avoids geometry crossing issues
# 1. Load world map
world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Extract Africa and Europe
africa <- world %>% filter(continent == "Africa")
europe <- world %>% filter(continent == "Europe")
# 3. Choose projections
# Mercator
merc_crs <- 3857
# Equal-area (LAEA) centered roughly between the regions
laea_crs <- "+proj=laea +lat_0=20 +lon_0=15"
# 4. Reproject each region
africa_merc <- st_transform(africa, merc_crs)
africa_laea <- st_transform(africa, laea_crs)
europe_merc <- st_transform(europe, merc_crs)
europe_laea <- st_transform(europe, laea_crs)
# 5. Add labels for faceting
africa_merc$region <- "Africa"
africa_laea$region <- "Africa"
europe_merc$region <- "Europe"
europe_laea$region <- "Europe"
africa_merc$proj <- "Mercator"
africa_laea$proj <- "Equal-area"
europe_merc$proj <- "Mercator"
europe_laea$proj <- "Equal-area"
# 6. Combine everything
combined <- rbind(
africa_merc,
africa_laea,
europe_merc,
europe_laea
)
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoid spherical geometry errors
# 1. Load world
world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Subsets
africa <- world[world$continent == "Africa", ]
europe <- world[world$continent == "Europe", ]
# 3. Projections
mercator  <- 3857
laea_af   <- "+proj=laea +lat_0=0   +lon_0=20"   # center for Africa
laea_eu   <- "+proj=laea +lat_0=55  +lon_0=15"   # center for Europe
#----- AFRICA -----
africa_merc <- st_transform(africa, mercator)
africa_laea <- st_transform(africa, laea_af)
p_africa_merc <- ggplot(africa_merc) +
geom_sf(fill="lightgray", color="black") +
ggtitle("Africa — Mercator") +
theme_minimal()
p_africa_laea <- ggplot(africa_laea) +
geom_sf(fill="lightgray", color="black") +
ggtitle("Africa — Equal-Area") +
theme_minimal()
#----- EUROPE -----
europe_merc <- st_transform(europe, mercator)
europe_laea <- st_transform(europe, laea_eu)
p_europe_merc <- ggplot(europe_merc) +
geom_sf(fill="lightgray", color="black") +
ggtitle("Europe — Mercator") +
theme_minimal()
p_europe_laea <- ggplot(europe_laea) +
geom_sf(fill="lightgray", color="black") +
ggtitle("Europe — Equal-Area") +
theme_minimal()
#----- COMBINE -----
(p_africa_merc | p_africa_laea) /
(p_europe_merc | p_europe_laea)
library(sf)
library(ggplot2)
library(rnaturalearth)
sf::sf_use_s2(FALSE)
# 1. Get Africa + Europe
world <- ne_countries(scale = "medium", returnclass = "sf")
af_eu <- world[world$continent %in% c("Africa", "Europe"), ]
# 2. Make two projected versions
merc <- st_transform(af_eu, 3857)   # Mercator
laea <- st_transform(af_eu, "+proj=laea +lat_0=30 +lon_0=10")  # Equal-area
# 3. Reproject both back to WGS84 for plotting
merc_wgs  <- st_transform(merc, 4326)
laea_wgs  <- st_transform(laea, 4326)
# 4. Plot both on the SAME MAP
ggplot() +
geom_sf(data = merc_wgs, fill = NA, color = "black", size = 0.6) +
geom_sf(data = laea_wgs, fill = NA, color = "red", size = 0.6) +
coord_sf(xlim = c(-30, 60), ylim = c(-40, 75), expand = FALSE) +
theme_minimal() +
ggtitle("Africa + Europe\nMercator (black) vs Equal-area (red)")
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
af_eu <- world[world$continent %in% c("Africa", "Europe"), ]
# 3. Projections
crs_mercator <- 3857
crs_equalarea <- "+proj=laea +lat_0=30 +lon_0=10"
# 4. Transform the region into each projection
af_eu_merc <- st_transform(af_eu, crs_mercator)
af_eu_laea <- st_transform(af_eu, crs_equalarea)
# 5. Make the two maps
p1 <- ggplot(af_eu_merc) +
geom_sf(fill = "lightgray", color = "black") +
theme_minimal() +
ggtitle("Africa + Europe — Mercator Projection")
p2 <- ggplot(af_eu_laea) +
geom_sf(fill = "lightgray", color = "black") +
theme_minimal() +
ggtitle("Africa + Europe — Equal-Area Projection (LAEA)")
# 6. Show them side-by-side
p1 | p2
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
af_eu_as <- world[world$continent %in% c("Africa", "Europe" , "Asia"), ]
# 3. Projections
crs_mercator <- 3857
crs_equalarea <- "+proj=laea +lat_0=30 +lon_0=10"
# 4. Transform the region into each projection
af_eu_as_merc <- st_transform(af_eu_as, crs_mercator)
af_eu_as_laea <- st_transform(af_eu_as, crs_equalarea)
# 5. Make the two maps
p1 <- ggplot(af_eu_as_merc) +
geom_sf(fill = "lightgray", color = "black") +
theme_minimal() +
ggtitle("Africa, Europe & Asia — Mercator Projection")
p2 <- ggplot(af_eu_as_laea) +
geom_sf(fill = "lightgray", color = "black") +
theme_minimal() +
ggtitle("Africa, Europe & Asia — Equal-Area Projection (LAEA)")
# 6. Show them side-by-side
p1 | p2
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
#world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
#af_eu_as <- world[world$continent %in% c("Africa", "Europe" , "Asia"), ]
af_eu_as <- st_read("Data/World_Continents.shp", quiet = TRUE)
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
#world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
#af_eu_as <- world[world$continent %in% c("Africa", "Europe" , "Asia"), ]
af_eu_as <- st_read("Data/World_Continents.shp", quiet = TRUE)
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
#world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
#af_eu_as <- world[world$continent %in% c("Africa", "Europe" , "Asia"), ]
af_eu_as <- st_read("/30DayMapChallenge2025/19Nov-Projections/World_Continents.shp", quiet = TRUE)
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
#world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
#af_eu_as <- world[world$continent %in% c("Africa", "Europe" , "Asia"), ]
af_eu_as <- st_read("30DayMapChallenge2025/19Nov-Projections/World_Continents.shp", quiet = TRUE)
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
#world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
#af_eu_as <- world[world$continent %in% c("Africa", "Europe" , "Asia"), ]
af_eu_as <- st_read("30DayMapChallenge2025/19Nov-Projections/World_Continents.shp", quiet = TRUE)
#install.packages("ggplot2")
library(sf)
library(ggplot2)
library(rnaturalearth)
library(patchwork)
sf::sf_use_s2(FALSE)   # avoids geometry issues
# 1. Load world map
#world <- ne_countries(scale = "medium", returnclass = "sf")
# 2. Select Africa + Europe region
#af_eu_as <- world[world$continent %in% c("Africa", "Europe" , "Asia"), ]
af_eu_as <- st_read("30DayMapChallenge2025/19Nov-Projections/World_Continents.shp", quiet = TRUE)
